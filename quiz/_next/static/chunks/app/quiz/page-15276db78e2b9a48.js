(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[602],{556:(e,t,r)=>{"use strict";r.d(t,{A:()=>i,AuthProvider:()=>l});var o=r(5155),s=r(2115);let n=(0,s.createContext)(void 0),l=e=>{let{children:t}=e,[r,l]=(0,s.useState)(null),[i,a]=(0,s.useState)(!0);(0,s.useEffect)(()=>{let e=localStorage.getItem("user");if(e)try{l(JSON.parse(e))}catch(e){console.log("Error parsing user data from localStorage:",e)}a(!1)},[]);let c=e=>{l(e),localStorage.setItem("user",JSON.stringify(e))},d=()=>{l(null),localStorage.removeItem("user")},u=(0,s.useMemo)(()=>({user:r,isAuthenticated:!!r,login:c,logout:d}),[r]);return(0,o.jsx)(n.Provider,{value:u,children:t})},i=()=>{let e=(0,s.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},1246:(e,t,r)=>{"use strict";r.d(t,{default:()=>T});var o=r(5155),s=r(2115),n=r(1574),l=r(9488),i=r(1942),a=r(6088),c=r(8638),d=r(5970),u=r(703),x=r(4193),h=r(9041),f=r(539),b=r(4627),g=r(4839),p=r(7291),m=r(3664),A=r(6621),j=r(2455),v=r(63),C=r(556),y=r(3522),S=r(6709),w=r(3170),I=r(2878),E=r(2271),q=r(2747),F=r(6618);let k=e=>{let t;if(!e)return[];let r=e.questionaireDb||[],o=r.length-1;for(let e=0;e<2*o;e++)t=Math.floor(Math.random()*o),[r[o],r[t]]=[r[t],r[o]];return r.slice(0,e.questionPerTest)},z=(e,t)=>{if(e.length!==t.length)return!1;let r=[...e].sort((e,t)=>e-t),o=[...t].sort((e,t)=>e-t);for(let e=0;e<r.length;e++)if(r[e]!==o[e])return!1;return!0},M=e=>{let{questions:t,quizState:r,userAnswers:s,scrollToQuestion:c}=e,d="finished"===r;return(0,o.jsxs)(n.A,{sx:{p:2,overflowY:"auto"},children:[(0,o.jsx)(l.A,{variant:"h6",gutterBottom:!0,children:"Question Matrix"}),(0,o.jsx)(i.A,{spacing:{xs:1,sm:2},direction:"column",useFlexGap:!0,sx:{flexWrap:"wrap"},children:t.map((e,t)=>{let r=s[e.questionId]&&s[e.questionId].length>0,l=d&&z(s[e.questionId]||[],e.answers);return(0,o.jsx)(a.A,{size:1,children:(0,o.jsx)(n.A,{onClick:()=>c(t),sx:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:40,cursor:"pointer",borderRadius:1,fontWeight:"bold",transition:"background-color 0.2s, transform 0.1s",bgcolor:d?l?"#4CAF50":"#F44336":r?"#6C6EEF":"#bdbdbd",color:"#fff","&:hover":{transform:"scale(1.05)",boxShadow:3}},children:t+1})},e.questionId)})})]})},T=function(){let e=(0,v.useSearchParams)(),{isAuthenticated:t}=(0,C.A)(),r=(0,v.useRouter)(),[i,T]=s.useState(null),[R,P]=s.useState({}),[D,N]=s.useState(1800),[W,B]=s.useState(!1),[O,Q]=s.useState("active"),[_,H]=s.useState(0),[K,G]=s.useState(null),[J,U]=s.useState(null),Y=s.useRef([]),L=s.useRef(null),V=s.useRef(null),X=s.useRef(null);s.useEffect(()=>{!1===t&&r.replace("/login")},[t,r]),s.useEffect(()=>{if(t){let t,o,s,n,l=e.get("id"),i=e.get("password"),a=e.get("iv"),c=e.get("salt");(t=l||null,o=i||null,s=a||null,n=c||null,new Promise((e,r)=>{!async function(){let l=await fetch("/data/".concat(t,".json")),i=null;if(o&&s&&n)try{let e=(0,F.Ms)(n),t=await (0,F.Hz)(o,e,["decrypt"]),r=await (0,F.af)(await l.text(),s,t);i=JSON.parse(r)}catch(e){console.log("Error:",e),r([])}else i=await l.json();e(i)}()})).then(e=>{e?(e.questionaire=k(e),T(e),Y.current=e.questionaire.map(()=>null),H(Date.now()),N(e.testTimeSeconds||1800),Q("active")):r.replace("/404")})}},[t,r]),s.useEffect(()=>{if(i&&D>0&&"active"===O){let e=setInterval(()=>{N(t=>t<=1?(clearInterval(e),$(!0),0):t-1)},1e3);return()=>clearInterval(e)}},[i,D,O]);let Z=(e,t,r)=>{"finished"!==O&&P(o=>{let s,n=o[e]||[];return s=r?n.includes(t)?n.filter(e=>e!==t):[...n,t].sort((e,t)=>e-t):[t],{...o,[e]:s}})},$=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!i||"active"!==O)return;G(Math.floor((Date.now()-_)/1e3));let t=0;i.questionaire.forEach(e=>{z(R[e.questionId]||[],e.answers)&&t++}),U(t),Q("finished"),e&&console.log("Quiz submitted automatically due to timeout."),L.current&&L.current.scrollTo({top:0,behavior:"smooth"})};if(!t||!i||0===_)return t?(0,o.jsx)(n.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,o.jsx)(c.A,{})}):null;let ee=i.questionaire.length,et=i.questionaire.filter(e=>{var t;return(null==(t=R[e.questionId])?void 0:t.length)>0}).length,er=et/ee*100,eo=(0,o.jsxs)(d.A,{ref:X,elevation:4,sx:{position:"sticky",top:0,zIndex:1e3,p:{xs:2,md:3},bgcolor:"#e3f2fd",borderBottom:"4px solid #6C6EEF"},children:[(0,o.jsxs)(l.A,{variant:"h5",sx:{fontWeight:700,mb:2,color:"#263238"},children:["Results for: ",i.quizName]}),(0,o.jsxs)(a.A,{container:!0,spacing:2,alignItems:"center",children:[(0,o.jsx)(a.A,{size:{xs:12,sm:4},children:(0,o.jsxs)(l.A,{variant:"h6",color:"success.dark",children:["Score:"," ",(0,o.jsxs)(n.A,{component:"span",sx:{fontWeight:"bold"},children:[J," / ",ee]})," ","Correct"]})}),(0,o.jsx)(a.A,{size:{xs:12,sm:4},children:(0,o.jsxs)(l.A,{variant:"h6",color:"primary.dark",children:["Time Taken:"," ",(0,o.jsx)(n.A,{component:"span",sx:{fontWeight:"bold"},children:(e=>{let t=Math.floor(e/3600),r=Math.floor(e%3600/60),o="";return t>0&&(o+="".concat(t,"h ")),(o+="".concat(r.toString().padStart(2,"0"),"m ").concat((e%60).toString().padStart(2,"0"),"s")).trim()})(K)})]})}),(0,o.jsxs)(a.A,{size:{xs:12,sm:4},sx:{display:"flex",gap:2,justifyContent:{xs:"center",sm:"flex-end"}},children:[(0,o.jsx)(u.A,{variant:"contained",onClick:()=>{if(!i)return void r.replace("/dashboard");i.questionaire=k(i),T(i),P({}),N(i.testTimeSeconds||1800),U(null),G(null),H(Date.now()),Q("active"),L.current&&L.current.scrollTo({top:0,behavior:"smooth"})},startIcon:(0,o.jsx)(I.A,{}),sx:{bgcolor:"#FFA726","&:hover":{bgcolor:"#FB8C00"},textTransform:"none"},children:"Retry"}),(0,o.jsx)(u.A,{variant:"outlined",onClick:()=>{r.push("/dashboard")},startIcon:(0,o.jsx)(w.A,{}),color:"primary",sx:{textTransform:"none"},children:"Home"})]})]})]}),es=(0,o.jsxs)(d.A,{ref:V,elevation:3,sx:{position:"sticky",top:0,zIndex:1e3,p:2,bgcolor:"#FFFFFF"},children:[(0,o.jsxs)(n.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsx)(l.A,{variant:"h6",color:"primary",sx:{fontWeight:600},children:i.quizName}),(0,o.jsxs)(n.A,{sx:{display:"flex",alignItems:"center"},children:[(0,o.jsxs)(l.A,{variant:"body1",color:"text.secondary",sx:{mr:2},fontSize:20,children:[et," / ",ee]}),(0,o.jsx)(x.A,{icon:(0,o.jsx)(y.A,{fontSize:"small"}),label:(e=>{let t=Math.floor(e/60);return"".concat(t.toString().padStart(2,"0"),":").concat((e%60).toString().padStart(2,"0"))})(D),color:D<60?"error":"primary",sx:{bgcolor:D<60?"#fce4ec":"#e8eaf6",color:D<60?"#d32f2f":"#3f51b5",fontWeight:"bold",fontSize:20}})]})]}),(0,o.jsx)(h.A,{variant:"determinate",value:er,sx:{height:8,mt:1,borderRadius:4,bgcolor:"#e0e0e0","& .MuiLinearProgress-bar":{bgcolor:"#6C6EEF"}}})]});return(0,o.jsxs)(n.A,{sx:{display:"flex",flexDirection:"column",height:"100vh",overflow:"hidden"},children:["active"===O?es:eo,(0,o.jsxs)(n.A,{ref:L,sx:{flexGrow:1,overflowY:"auto",p:{xs:2,md:4},backgroundColor:"#f5f5f5"},children:[i.questionaire.map((e,t)=>{let r=e.answers.length>1,s=R[e.questionId]||[],i="finished"===O,c=i&&z(s,e.answers);return(0,o.jsx)(f.A,{sx:{mb:3,p:{xs:2,md:3},borderRadius:2,boxShadow:3,border:i?c?"2px solid #4CAF50":"2px solid #F44336":s.length>0?"2px solid #6C6EEF":"1px solid #e0e0e0"},children:(0,o.jsxs)(b.A,{children:[(0,o.jsxs)(n.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,o.jsxs)(l.A,{variant:"subtitle1",color:"text.secondary",gutterBottom:!0,children:["QUESTION ",t+1," of ",ee]}),i&&(0,o.jsx)(x.A,{icon:c?(0,o.jsx)(E.A,{}):(0,o.jsx)(q.A,{}),label:c?"Correct":"Incorrect",color:c?"success":"error",variant:"filled"})]}),(0,o.jsx)(l.A,{variant:"h5",sx:{mb:3,fontWeight:500},children:e.question}),(0,o.jsx)(g.A,{sx:{mb:3}}),(0,o.jsx)(a.A,{container:!0,spacing:2,children:e.options.map((t,n)=>{let c=s.includes(n),d=e.answers.includes(n),u=i?d&&c?{bgcolor:"#e8f5e9",border:"1px solid #4CAF50",labelColor:"success.dark"}:d&&!c?{bgcolor:"#e8f5e9",border:"1px solid #4CAF50",labelColor:"#388E3C"}:!d&&c?{bgcolor:"#ffebee",border:"1px solid #F44336",labelColor:"error.dark"}:{bgcolor:"#fff",border:"none",labelColor:"text.primary"}:{bgcolor:"#fff",border:"none",labelColor:"text.primary"};return(0,o.jsx)(a.A,{size:12,children:r?(0,o.jsx)(p.A,{disabled:i,control:(0,o.jsx)(m.A,{checked:c,onChange:()=>Z(e.questionId,n,!0),sx:{color:u.labelColor}}),label:(0,o.jsx)(l.A,{color:u.labelColor,children:t})}):(0,o.jsx)(p.A,{disabled:i,control:(0,o.jsx)(A.A,{checked:c,onChange:()=>Z(e.questionId,n,!1),sx:{color:u.labelColor}}),label:(0,o.jsx)(l.A,{color:u.labelColor,children:t})})},n)})})]})},e.questionId)}),"active"===O&&(0,o.jsx)(n.A,{sx:{mt:5,mb:10,display:"flex",justifyContent:"center"},children:(0,o.jsx)(u.A,{variant:"contained",color:"success",size:"large",onClick:()=>$(!1),sx:{bgcolor:"#4CAF50","&:hover":{bgcolor:"#388E3C"},p:1.5},children:"Submit Quiz"})}),(0,o.jsx)(n.A,{sx:{height:80}})]}),(0,o.jsx)(j.Ay,{anchor:"right",open:W,onClose:()=>B(!1),children:(0,o.jsx)(M,{questions:i.questionaire,quizState:O,userAnswers:R,scrollToQuestion:e=>{let t=Y.current[e],r="active"===O?V.current:X.current;if(t&&L.current&&r){let e=r.offsetHeight;L.current.scrollTo({top:t.offsetTop-e-20,behavior:"smooth"})}window.innerWidth<600&&B(!1)}})}),(0,o.jsx)(n.A,{sx:{position:"fixed",bottom:16,right:16,zIndex:1100},children:(0,o.jsx)(u.A,{variant:"contained",onClick:()=>B(!0),startIcon:(0,o.jsx)(S.A,{}),sx:{backgroundColor:"#6C6EEF","&:hover":{backgroundColor:"#5A5AD0"},boxShadow:6,borderRadius:"50px",p:1.5},children:"active"===O?"Question Matrix (".concat(et,"/").concat(ee,")"):"Review Matrix"})})]})}},3060:(e,t,r)=>{Promise.resolve().then(r.bind(r,1246))},6618:(e,t,r)=>{"use strict";r.d(t,{Hz:()=>s,Ms:()=>o,af:()=>n});let o=e=>{let t=atob(e),r=t.length,o=new Uint8Array(r);for(let e=0;e<r;e++)o[e]=t.charCodeAt(e);return o.buffer},s=async(e,t,r)=>{let o=new TextEncoder().encode(e),s=await crypto.subtle.importKey("raw",o,{name:"PBKDF2"},!1,["deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:t,iterations:1e5,hash:"SHA-256"},s,{name:"AES-GCM",length:256},!0,r)},n=async(e,t,r)=>{let s=o(e),n=o(t),l=await crypto.subtle.decrypt({name:"AES-GCM",iv:n},r,s);return new TextDecoder().decode(l)}}},e=>{e.O(0,[742,464,624,587,948,441,255,358],()=>e(e.s=3060)),_N_E=e.O()}]);