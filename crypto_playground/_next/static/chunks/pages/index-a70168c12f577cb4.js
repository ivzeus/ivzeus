(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{5899:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>j});var l=r(7876),a=r(9146),n=r(6304),i=r(4232);async function s(e,t,r){let l=d(t),a=d(r),n=await crypto.subtle.importKey("raw",l.buffer,{name:"AES-GCM"},!1,["encrypt"]),i=new TextEncoder().encode(e);var s=new Uint8Array(await crypto.subtle.encrypt({name:"AES-GCM",iv:a.buffer},n,i.buffer));let o="";for(let e=0;e<s.length;e++)o+=String.fromCharCode(s[e]);return btoa(o)}async function o(e,t,r){let l=d(t),a=d(r),n=await crypto.subtle.importKey("raw",l.buffer,{name:"AES-GCM"},!1,["decrypt"]),i=function(e){let t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}(e),s=await crypto.subtle.decrypt({name:"AES-GCM",iv:a.buffer},n,i.buffer);return new TextDecoder().decode(s)}function d(e){let t=e.replace(/[^0-9a-fA-F]/g,"");if(t.length%2!=0)throw Error("Invalid hex string");let r=new Uint8Array(t.length/2);for(let e=0;e<r.length;e++)r[e]=parseInt(t.substr(2*e,2),16);return r}function u(e){return Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}function c(e){let t=new Uint8Array(e);return crypto.getRandomValues(t),u(t)}async function h(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e5,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32,a=new TextEncoder,n=await crypto.subtle.importKey("raw",a.encode(e),{name:"PBKDF2"},!1,["deriveBits"]),i=d(t);return u(new Uint8Array(await crypto.subtle.deriveBits({name:"PBKDF2",salt:i.buffer,iterations:r,hash:"SHA-256"},n,8*l)))}var f=r(2008),x=r(3473),p=r(1900),b=r(1349),y=r(472),A=r(2099),g=r(2912);function v(){let[e,t]=(0,i.useState)("aes-gcm"),[r,a]=(0,i.useState)(""),[d,u]=(0,i.useState)(""),[v,j]=(0,i.useState)(""),[m,C]=(0,i.useState)("pbkdf2"),[S,E]=(0,i.useState)(1e5),[k,K]=(0,i.useState)("256"),[I,D]=(0,i.useState)(""),[_,G]=(0,i.useState)(""),[M,U]=(0,i.useState)(""),[N,T]=(0,i.useState)(""),[F,B]=(0,i.useState)(!1);return(0,l.jsxs)(f.A,{display:"flex",flexDirection:"column",gap:2,children:[(0,l.jsxs)(g.A,{fullWidth:!0,children:[(0,l.jsx)(A.A,{id:"method-label",children:"Method"}),(0,l.jsxs)(y.A,{labelId:"method-label",value:e,label:"Method",onChange:e=>t(e.target.value),children:[(0,l.jsx)(p.A,{value:"aes-gcm",children:"AES-GCM"}),(0,l.jsx)(p.A,{value:"rot13",children:"ROT13"}),(0,l.jsx)(p.A,{value:"base64",children:"Base64"})]})]}),"aes-gcm"===e&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(f.A,{display:"flex",gap:2,alignItems:"center",children:(0,l.jsx)(b.A,{label:"Password",type:"password",value:d,onChange:e=>u(e.target.value),fullWidth:!0,helperText:"Optional â€” provide to derive a key from password"})}),(0,l.jsxs)(f.A,{display:"flex",gap:2,alignItems:"center",children:[(0,l.jsx)(b.A,{label:"IV (hex)",value:I,onChange:e=>D(e.target.value),helperText:"Hex (recommended 12 bytes / 96 bits)",fullWidth:!0}),(0,l.jsx)(x.A,{onClick:()=>D(c(12)),children:"Generate IV"})]}),(0,l.jsxs)(f.A,{display:"flex",gap:2,alignItems:"center",children:[(0,l.jsx)(b.A,{label:"Salt (hex)",value:v,onChange:e=>j(e.target.value),helperText:"Hex (recommended 16 bytes)",fullWidth:!0}),(0,l.jsx)(x.A,{onClick:()=>j(c(16)),children:"Generate Salt"})]}),(0,l.jsxs)(f.A,{display:"flex",gap:2,alignItems:"center",children:[(0,l.jsxs)(g.A,{children:[(0,l.jsx)(A.A,{id:"kdf-label",children:"KDF"}),(0,l.jsx)(y.A,{labelId:"kdf-label",value:m,label:"KDF",onChange:e=>C(e.target.value),children:(0,l.jsx)(p.A,{value:"pbkdf2",children:"PBKDF2 (SHA-256)"})})]}),(0,l.jsx)(b.A,{label:"Iterations",type:"number",value:S,onChange:e=>E(Number(e.target.value))}),(0,l.jsxs)(g.A,{children:[(0,l.jsx)(A.A,{id:"keybits-label",children:"Key bits"}),(0,l.jsxs)(y.A,{labelId:"keybits-label",value:k,label:"Key bits",onChange:e=>K(e.target.value),children:[(0,l.jsx)(p.A,{value:"128",children:"128"}),(0,l.jsx)(p.A,{value:"192",children:"192"}),(0,l.jsx)(p.A,{value:"256",children:"256"})]})]}),(0,l.jsx)(x.A,{onClick:async()=>{try{if(T(""),!d)throw Error("Password required");v||j(c(16));let e=await h(d,v||c(16),S,Number(k)/8);a(e)}catch(t){var e;T(String(null!=(e=null==t?void 0:t.message)?e:t))}},children:"Derive Key"})]}),(0,l.jsx)(f.A,{display:"flex",gap:2,children:(0,l.jsx)(b.A,{label:"Key (hex)",value:r,onChange:e=>a(e.target.value),helperText:"Derived hex key or paste your own (e.g. 32 bytes hex for 256-bit)",fullWidth:!0})})]}),(0,l.jsx)(b.A,{label:"Input",multiline:!0,minRows:8,value:_,onChange:e=>G(e.target.value),fullWidth:!0}),(0,l.jsxs)(f.A,{display:"flex",gap:2,children:[(0,l.jsx)(x.A,{variant:"contained",onClick:function(){T(""),(async()=>{B(!0);try{if("rot13"===e)U(w(_));else if("base64"===e)U(btoa(_));else{if(!r){if(!d)throw Error("Key or password required for AES-GCM");if(!v)throw Error("Salt required to derive key");if("pbkdf2"===m){let e=await h(d,v,S,Number(k)/8);a(e)}else throw Error("Unsupported KDF")}if(!I)throw Error("IV required for AES-GCM");let e=await s(_,r,I);U(e)}}catch(e){var t;T(String(null!=(t=null==e?void 0:e.message)?t:e))}finally{B(!1)}})()},disabled:F,children:"Encrypt"}),(0,l.jsx)(x.A,{variant:"outlined",onClick:function(){T(""),(async()=>{B(!0);try{if("rot13"===e)U(w(_));else if("base64"===e)U(atob(_));else{if(!r){if(!d)throw Error("Key or password required for AES-GCM");if(!v)throw Error("Salt required to derive key");if("pbkdf2"===m){let e=await h(d,v,S,Number(k)/8);a(e)}else throw Error("Unsupported KDF")}if(!I)throw Error("IV required for AES-GCM");let e=await o(_,r,I);U(e)}}catch(e){var t;T(String(null!=(t=null==e?void 0:e.message)?t:e))}finally{B(!1)}})()},disabled:F,children:"Decrypt"}),(0,l.jsx)(x.A,{variant:"text",onClick:()=>{G("")},children:"Clear input"})]}),(0,l.jsx)(n.A,{color:"error",children:N}),F&&(0,l.jsx)(n.A,{variant:"body2",children:"Working..."}),(0,l.jsx)(b.A,{label:"Output",multiline:!0,minRows:8,value:M,onChange:e=>U(e.target.value),fullWidth:!0}),(0,l.jsx)(f.A,{display:"flex",justifyContent:"flex-end",children:(0,l.jsx)(x.A,{variant:"contained",onClick:function(){let e=new Blob([M],{type:"text/plain;charset=utf-8"}),t=URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download="output.txt",r.click(),URL.revokeObjectURL(t)},disabled:!M,children:"Save Output"})})]})}function w(e){return e.replace(/[a-zA-Z]/g,e=>{let t=e.charCodeAt(0);return t>=65&&t<=90?String.fromCharCode((t-65+13)%26+65):t>=97&&t<=122?String.fromCharCode((t-97+13)%26+97):e})}let j=()=>(0,l.jsxs)(a.A,{className:"container",children:[(0,l.jsx)(n.A,{variant:"h4",component:"h1",gutterBottom:!0,children:"Cryptography Playground"}),(0,l.jsx)(v,{})]})},6760:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(5899)}])}},e=>{e.O(0,[79,636,593,792],()=>e(e.s=6760)),_N_E=e.O()}]);